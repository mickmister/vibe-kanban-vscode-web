services:
  code-vibe:
    build:
      context: .
      args:
        VIBE_KANBAN_VERSION: "latest"

    ports:
      - "${CADDY_PORT:-3001}:3001"         # caddy (main entry point)
      - "${VIBE_KANBAN_PORT:-3007}:3007"   # vibe-kanban (direct access)
      - "${VS_CODE_PORT:-3008}:3008"       # vscode (direct access)

    environment:
      VIBE_KANBAN_VERSION: ${VIBE_KANBAN_VERSION:-latest}
      CADDY_PORT: 3001
      BACKEND_PORT: 3007 # vibe-kanban
      PORT: 3008 # vscode

      PASSWORD: ${CODE_PASSWORD}
      SUDO_PASSWORD: ${SUDO_PASSWORD}
